// prisma/schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Player {
  id                    String   @id // player_id from Sleeper
  fullName              String?
  firstName             String?
  lastName              String?
  position              String?
  team                  String?
  teamAbbr              String?
  status                String?
  active                Boolean  @default(false)
  yearsExp              Int?
  age                   Int?
  height                String?
  weight                String?
  college               String?
  birthDate             String?
  fantasyPositions      String   // JSON string for SQLite
  injuryStatus          String?
  injuryBodyPart        String?
  injuryNotes           String?
  depthChartPosition    String?
  depthChartOrder       Int?
  searchRank            Int?
  
  // External IDs
  espnId                Int?
  yahooId               Int?
  rotowireId            Int?
  statsId               Int?
  fantasyDataId         Int?
  
  // Metadata
  lastUpdated           DateTime @default(now()) @updatedAt
  createdAt             DateTime @default(now())
  
  @@map("players")
}

model PlayerSyncLog {
  id          Int      @id @default(autoincrement())
  syncedAt    DateTime @default(now())
  playerCount Int
  success     Boolean  @default(true)
  errorMsg    String?
  
  @@map("player_sync_logs")
}

model Schedule {
  id        String @id @default(cuid())
  year      Int
  week      Int
  homeTeam  String
  awayTeam  String 
  time      String // The detail field with date/time
  broadcast String? // Single broadcast network
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([year, week, homeTeam, awayTeam])
  @@map("schedules")
}

model Team {
  id            String   @id @default(cuid())
  espnTeamId    Int      @unique
  name          String
  abbreviation  String
  season        Int      @default(2025)
  wins          Int      @default(0)
  losses        Int      @default(0)
  ties          Int      @default(0)
  winPercentage Float    @default(0)
  logoUrl       String?
  updatedAt     DateTime @updatedAt
  createdAt     DateTime @default(now())
  
  @@unique([espnTeamId, season])
  @@map("teams")
}